var _0x27de=['filename','/conversation/','7d79569a-2c18-418f-8248-39bb6f0ba9e2','message','error','status','es-en','translate','application/json','tone','/personalidad','text','text/plain','profile','Running\x20on\x20port\x20','express','body-parser','path','multer','ejs','use','./public','set','view\x20engine','PORT','watson-developer-cloud/assistant/v1','watson-developer-cloud/tone-analyzer/v3','watson-developer-cloud/language-translator/v3','watson-developer-cloud/personality-insights/v3','watson-developer-cloud/visual-recognition/v3','2018-11-16','qegEiilB3rN5HxT_nBmLe1ngJ34Yefz_cDLNYfMYyKrm','2017-09-21','94f50e56-cdaf-4375-8811-8747269b097b','6dNiXPPkOp1X','2018-05-01','LtDg9by5NtjrjTzFgfXjwiWRf1GS65-czl0KVlxGf71m','2018-09-20','009e8029-690b-437d-b4d6-2416695f3787','zMyx1NXIMsYb','https://gateway.watsonplatform.net/assistant/api','2018-03-19','1c5YGEPlFyjF2mbkdrdzJuz96Cix3j4s2wrr3coA_oFT','2017-10-13','ut1-5fp__hkX9WiU7gOb7skEykC0cucFbsSdHKO0lOzu','https://gateway.watsonplatform.net/personality-insights/api','diskStorage','join','public/uploads','originalname','single','imagen','test','extname','toLowerCase','Error','get','/recognition','render','recognition','/personality','/NLU','NLU','post','/NLU/','analyze','log','error:','stringify','json','/NLUTextEmotions/','body','/NLUTextConcepts/','/upload','file','Error:\x20No\x20File\x20Selected!','createReadStream','./public/uploads/','classify','File\x20Uploaded!','uploads/'];(function(_0x164867,_0x499e92){var _0x1d8433=function(_0x28fb1f){while(--_0x28fb1f){_0x164867['push'](_0x164867['shift']());}};_0x1d8433(++_0x499e92);}(_0x27de,0x153));var _0x332a=function(_0x248793,_0x2129d5){_0x248793=_0x248793-0x0;var _0xa608d9=_0x27de[_0x248793];return _0xa608d9;};var express=require(_0x332a('0x0'));var bodyParser=require(_0x332a('0x1'));var fs=require('fs');var path=require(_0x332a('0x2'));var multer=require(_0x332a('0x3'));var ejs=require(_0x332a('0x4'));var app=express();app[_0x332a('0x5')](bodyParser['json']());app[_0x332a('0x5')](express['static'](_0x332a('0x6')));app[_0x332a('0x7')](_0x332a('0x8'),'ejs');app[_0x332a('0x5')](bodyParser['urlencoded']({'extended':!![]}));var port=process['env'][_0x332a('0x9')]||0x3e8;var AssistantV1=require(_0x332a('0xa'));var ToneAnalyzerV3=require(_0x332a('0xb'));var LanguageTranslatorV3=require(_0x332a('0xc'));var PersonalityInsightsV3=require(_0x332a('0xd'));var NaturalLanguageUnderstandingV1=require('watson-developer-cloud/natural-language-understanding/v1.js');var VisualRecognitionV3=require(_0x332a('0xe'));var naturalLanguageUnderstanding=new NaturalLanguageUnderstandingV1({'version':_0x332a('0xf'),'iam_apikey':_0x332a('0x10'),'url':'https://gateway.watsonplatform.net/natural-language-understanding/api'});var toneAnalyzer=new ToneAnalyzerV3({'version_date':_0x332a('0x11'),'username':_0x332a('0x12'),'password':_0x332a('0x13')});var languageTranslator=new LanguageTranslatorV3({'version':_0x332a('0x14'),'iam_apikey':_0x332a('0x15')});var assistant=new AssistantV1({'version':_0x332a('0x16'),'username':_0x332a('0x17'),'password':_0x332a('0x18'),'url':_0x332a('0x19')});var visualRecognition=new VisualRecognitionV3({'version':_0x332a('0x1a'),'iam_apikey':_0x332a('0x1b')});var personalityInsights=new PersonalityInsightsV3({'version_date':_0x332a('0x1c'),'iam_apikey':_0x332a('0x1d'),'url':_0x332a('0x1e')});var storage=multer[_0x332a('0x1f')]({'destination':path[_0x332a('0x20')](__dirname,_0x332a('0x21')),'filename':(_0x501541,_0x1bac95,_0xe4fd95)=>{_0xe4fd95(null,_0x1bac95[_0x332a('0x22')]);}});var upload=multer({'storage':storage,'dest':path[_0x332a('0x20')](__dirname,_0x332a('0x21')),'limits':{'fileSize':0xf4240},'fileFilter':function(_0x283c4a,_0xa34925,_0x31c8cc){checkFileType(_0xa34925,_0x31c8cc);}})[_0x332a('0x23')](_0x332a('0x24'));function checkFileType(_0x47bbc0,_0x359d53){const _0x4bfd86=/jpeg|jpg|png/;const _0x123d4f=_0x4bfd86[_0x332a('0x25')](path[_0x332a('0x26')](_0x47bbc0[_0x332a('0x22')])[_0x332a('0x27')]());const _0x6a00cd=_0x4bfd86[_0x332a('0x25')](_0x47bbc0['mimetype']);if(_0x6a00cd&&_0x123d4f){return _0x359d53(null,!![]);}else{_0x359d53(_0x332a('0x28'));}}app[_0x332a('0x29')](_0x332a('0x2a'),(_0x506305,_0x290256)=>{_0x290256[_0x332a('0x2b')](_0x332a('0x2c'));});app[_0x332a('0x29')](_0x332a('0x2d'),(_0x59edce,_0x4ce30f)=>{_0x4ce30f[_0x332a('0x2b')]('personality');});app[_0x332a('0x29')](_0x332a('0x2e'),(_0x107fcf,_0x39f0f9)=>{_0x39f0f9[_0x332a('0x2b')](_0x332a('0x2f'));});app[_0x332a('0x30')](_0x332a('0x31'),(_0x11329e,_0x50d82e)=>{var {URL={}}=_0x11329e['body'];var _0x12457c={'url':URL,'features':{'concepts':{'limit':0xa},'keywords':{'sentiment':!![],'emotion':!![],'limit':0x5},'emotion':{'limit':0x14}}};naturalLanguageUnderstanding[_0x332a('0x32')](_0x12457c,function(_0x135e83,_0x3b057e){if(_0x135e83)console[_0x332a('0x33')](_0x332a('0x34'),_0x135e83);else console[_0x332a('0x33')](JSON[_0x332a('0x35')](_0x3b057e,null,0x2));_0x50d82e[_0x332a('0x36')](_0x3b057e);});});app[_0x332a('0x30')](_0x332a('0x37'),(_0x34ed99,_0x4f83c5)=>{var {textNLU={}}=_0x34ed99[_0x332a('0x38')];var _0x4affa0={'text':textNLU,'features':{'concepts':{'limit':0x5},'keywords':{'sentiment':!![],'emotion':!![],'limit':0x5},'emotion':{'limit':0x14}}};naturalLanguageUnderstanding['analyze'](_0x4affa0,function(_0x3c4740,_0x6b6d1e){if(_0x3c4740)console[_0x332a('0x33')]('error:',_0x3c4740);else console[_0x332a('0x33')](JSON[_0x332a('0x35')](_0x6b6d1e,null,0x2));_0x4f83c5['json'](_0x6b6d1e);});});app['post'](_0x332a('0x39'),(_0x494a7b,_0x374135)=>{var {textNLUConcepts={}}=_0x494a7b['body'];var _0x41abf0={'text':textNLUConcepts,'features':{'concepts':{'limit':0x5},'keywords':{'sentiment':!![],'emotion':!![],'limit':0x5},'emotion':{'limit':0x14}}};naturalLanguageUnderstanding['analyze'](_0x41abf0,function(_0x41485e,_0x32232c){if(_0x41485e)console[_0x332a('0x33')](_0x332a('0x34'),_0x41485e);else console['log'](JSON[_0x332a('0x35')](_0x32232c,null,0x2));_0x374135[_0x332a('0x36')](_0x32232c);});});app[_0x332a('0x30')](_0x332a('0x3a'),(_0x579cc8,_0x255574)=>{upload(_0x579cc8,_0x255574,_0x28d229=>{if(_0x28d229){_0x255574[_0x332a('0x2b')]('recognition',{'msg':_0x28d229});}else{if(_0x579cc8[_0x332a('0x3b')]==undefined){_0x255574[_0x332a('0x2b')](_0x332a('0x2c'),{'msg':_0x332a('0x3c')});}else{var _0xc6d470=_0x579cc8[_0x332a('0x3b')][_0x332a('0x22')];var _0x3a7641=fs[_0x332a('0x3d')](_0x332a('0x3e')+_0xc6d470);var _0x54b4d0={'images_file':_0x3a7641,'accept_language':'es'};visualRecognition[_0x332a('0x3f')](_0x54b4d0,function(_0x28d229,_0x3f629f){if(_0x28d229){console[_0x332a('0x33')](_0x28d229);}else{var _0x2a93a9=_0x3f629f;_0x255574[_0x332a('0x2b')]('recognition',{'msg':_0x332a('0x40'),'file':_0x332a('0x41')+_0x579cc8[_0x332a('0x3b')][_0x332a('0x42')],'info':_0x2a93a9});}});}}});});app[_0x332a('0x30')](_0x332a('0x43'),(_0x3fd7d1,_0x1d2cfd)=>{const {text,context={}}=_0x3fd7d1['body'];const _0x28234b={'input':{'text':text},'workspace_id':_0x332a('0x44'),'context':context};assistant[_0x332a('0x45')](_0x28234b,(_0x317481,_0x1d41ed)=>{if(_0x317481){console[_0x332a('0x46')](_0x317481);_0x1d2cfd[_0x332a('0x47')](0x1f4)[_0x332a('0x36')](_0x317481);}else{_0x1d2cfd['json'](_0x1d41ed);}});});app[_0x332a('0x30')]('/CustomerEngagement',(_0x43d2db,_0x4200b2)=>{var {traduce={}}=_0x43d2db[_0x332a('0x38')];var _0x1486f3={'text':traduce,'model_id':_0x332a('0x48')};languageTranslator[_0x332a('0x49')](_0x1486f3,function(_0x1a6ab6,_0x22749c){if(_0x1a6ab6){console['log'](_0x1a6ab6);}else{console[_0x332a('0x33')](JSON[_0x332a('0x35')](_0x22749c,null,0x2));_0x4200b2[_0x332a('0x36')](_0x22749c);}});var {text={}}=_0x43d2db['body'];var _0x55c024={'tone_input':{'text':text},'content_type':_0x332a('0x4a'),'accept_language':'es'};toneAnalyzer[_0x332a('0x4b')](_0x55c024,function(_0x33363b,_0x37523c){if(_0x33363b){console[_0x332a('0x33')](_0x33363b);}else{console[_0x332a('0x33')](JSON[_0x332a('0x35')](_0x37523c,null,0x2));_0x4200b2[_0x332a('0x36')](_0x37523c);}});});app['post'](_0x332a('0x4c'),function(_0x1d975a,_0xc2dc79){var _0x1b76f4=_0x1d975a['body'][_0x332a('0x4d')];console[_0x332a('0x33')](_0x1b76f4);var _0x23bfaa={'content':_0x1b76f4,'content_type':_0x332a('0x4e'),'raw_scores':!![],'accept_language':'es'};personalityInsights[_0x332a('0x4f')](_0x23bfaa,function(_0x4bc9db,_0x1ceb7c){if(_0x4bc9db){console['log'](_0x4bc9db);}else{console['log'](JSON[_0x332a('0x35')](_0x1ceb7c,null,0x2));_0xc2dc79[_0x332a('0x36')](_0x1ceb7c);}});});app['listen'](port,()=>console[_0x332a('0x33')](_0x332a('0x50')+port));